---
import Layout from '../layouts/Layout.astro';
import { generateToken } from '../lib/generateToken';
import LoginComp from '../components/LoginComp'

export const prerender = false;

const token = generateToken();
Astro.cookies.set('logToken', token, 
{
    httpOnly: true, // Prevents JavaScript access
    sameSite: "strict", // Protects against CSRF
    maxAge: 60 * 15,
  }
);

const isAuthorized = Astro.cookies.has('auth_token');

if(isAuthorized == true){
    return Astro.redirect("/ctdi");
} else {
    console.log('not login yet');
}
---

<Layout title="Login Form">
    <LoginComp client:load/>
</Layout>
